/*
 * This file was generated by `pastoria`.
 * @generated-checksum 1170f111d3f03f6828058991b428c4f1afa31dc5eb46ed8a613d78b42f1874d1
 * Do not modify this file directly. Instead, edit the template at js_resource.ts.
 */

import type {JSResourceReference} from 'react-relay/hooks';

type ResourceConf = typeof RESOURCE_CONF;
const RESOURCE_CONF = {
  "m#commander_stats": {
      src: "src/commander_page.tsx",
      loader: () => import("../../src/commander_page").then(m => m.CommanderStats)
    },
  "m#commander_page": {
      src: "src/commander_page.tsx",
      loader: () => import("../../src/commander_page").then(m => m.CommanderPage)
    },
  "m#commander_page_shell": {
      src: "src/commander_page.tsx",
      loader: () => import("../../src/commander_page").then(m => m.CommanderPageShell)
    },
  "route(/)": {
      src: "src/commanders.tsx",
      loader: () => import("../../src/commanders").then(m => m.CommandersPageShell)
    },
  "m#index": {
      src: "src/commanders.tsx",
      loader: () => import("../../src/commanders").then(m => m.CommandersPage)
    },
  "route(/staples)": {
      src: "src/staples.tsx",
      loader: () => import("../../src/staples").then(m => m.StaplesPageShell)
    },
  "route(/staples)#staples_page": {
      src: "src/staples.tsx",
      loader: () => import("../../src/staples").then(m => m.StaplesPage)
    },
  "m#tournament_page_shell": {
      src: "src/tournament_view.tsx",
      loader: () => import("../../src/tournament_view").then(m => m.TournamentPageShell)
    },
  "m#tournament_view": {
      src: "src/tournament_view.tsx",
      loader: () => import("../../src/tournament_view").then(m => m.TournamentViewPage)
    },
  "route(/tournaments)": {
      src: "src/tournaments.tsx",
      loader: () => import("../../src/tournaments").then(m => m.TournamentsPageShell)
    },
  "route(/tournaments)#tournaments": {
      src: "src/tournaments.tsx",
      loader: () => import("../../src/tournaments").then(m => m.TournamentsPage)
    },
  "route(/about)": {
      src: "pastoria/about/page.tsx",
      loader: () => import("#pastoria/about/page").then(m => m.default),
    }
} as const;

type ModuleId = keyof ResourceConf;
export type ModuleType<M extends ModuleId> = Awaited<
  ReturnType<ResourceConf[M]['loader']>
>;

export class JSResource<M extends ModuleId>
  implements JSResourceReference<ModuleType<M>>
{
  static srcOfModuleId(id: string): string | null {
    return RESOURCE_CONF[id as ModuleId].src;
  }

  private static readonly resourceCache = new Map<ModuleId, JSResource<any>>();
  static fromModuleId<M extends ModuleId>(moduleId: M) {
    if (JSResource.resourceCache.has(moduleId)) {
      return JSResource.resourceCache.get(moduleId)!;
    }

    const resource = new JSResource(moduleId);
    JSResource.resourceCache.set(moduleId, resource);
    return resource;
  }

  private constructor(private readonly moduleId: M) {}
  private modulePromiseCache: Promise<ModuleType<M>> | null = null;
  private moduleCache: ModuleType<M> | null = null;

  getModuleId(): string {
    return this.moduleId;
  }

  getModuleIfRequired(): ModuleType<M> | null {
    return this.moduleCache;
  }

  async load(): Promise<ModuleType<M>> {
    if (this.modulePromiseCache == null) {
      this.modulePromiseCache = RESOURCE_CONF[this.moduleId]
        .loader()
        .then((m) => {
          this.moduleCache = m as ModuleType<M>;
          return this.moduleCache;
        });
    }

    return await this.modulePromiseCache;
  }
}
